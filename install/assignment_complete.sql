SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";


CREATE TABLE IF NOT EXISTS follows (
  follow_id bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  user_id bigint(20) unsigned NOT NULL,
  follow_user_id bigint(20) unsigned NOT NULL,
  created timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  modified timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (follow_id),
  UNIQUE KEY user_id_2 (user_id,follow_user_id),
  KEY user_id (user_id,follow_user_id),
  KEY subscription_user_id (follow_user_id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=38 ;

INSERT INTO follows VALUES(1, 1, 2, '2014-04-01 02:45:27', '2014-04-01 02:45:27');
INSERT INTO follows VALUES(8, 2, 1, '2014-04-08 06:18:26', '2014-04-08 06:18:26');
INSERT INTO follows VALUES(20, 17, 17, '2014-04-08 06:26:50', '2014-04-08 06:26:50');
INSERT INTO follows VALUES(27, 2, 2, '2014-04-08 06:31:31', '2014-04-08 06:31:31');
INSERT INTO follows VALUES(29, 2, 13, '2014-04-08 06:33:21', '2014-04-08 06:33:21');
INSERT INTO follows VALUES(31, 2, 17, '2014-04-08 06:33:23', '2014-04-08 06:33:23');
INSERT INTO follows VALUES(35, 17, 1, '2014-04-08 06:50:05', '2014-04-08 06:50:05');
INSERT INTO follows VALUES(36, 17, 2, '2014-04-08 06:50:05', '2014-04-08 06:50:05');
INSERT INTO follows VALUES(37, 17, 13, '2014-04-08 06:50:06', '2014-04-08 06:50:06');

CREATE TABLE IF NOT EXISTS msgs (
  msg_id bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  user_id bigint(20) unsigned NOT NULL,
  attribution_user_id bigint(20) unsigned DEFAULT NULL,
  msg varchar(140) NOT NULL,
  created timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  modified timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (msg_id),
  KEY userid (user_id,attribution_user_id),
  KEY attribution_msg_id (attribution_user_id)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=27 ;

INSERT INTO msgs VALUES(1, 1, NULL, 'this is my new msg', '2014-04-01 02:17:31', '2014-04-01 02:17:31');
INSERT INTO msgs VALUES(2, 2, NULL, 'This is a test msg YAY', '2014-04-01 02:45:43', '2014-04-01 02:45:43');
INSERT INTO msgs VALUES(3, 2, NULL, 'this is my new msg', '2014-04-05 05:07:52', '2014-04-05 05:07:52');
INSERT INTO msgs VALUES(4, 2, NULL, 'this is my new msg', '2014-04-05 05:08:14', '2014-04-05 05:08:14');
INSERT INTO msgs VALUES(5, 2, NULL, 'this is my new msg', '2014-04-05 05:08:17', '2014-04-05 05:08:17');
INSERT INTO msgs VALUES(6, 2, NULL, 'this is my new msg', '2014-04-05 05:09:59', '2014-04-05 05:09:59');
INSERT INTO msgs VALUES(7, 2, NULL, 'this is my new msg', '2014-04-05 05:10:23', '2014-04-05 05:10:23');
INSERT INTO msgs VALUES(8, 2, NULL, 'this is my new msg', '2014-04-05 05:14:13', '2014-04-05 05:14:13');
INSERT INTO msgs VALUES(9, 2, NULL, 'this is my new msg', '2014-04-05 05:14:37', '2014-04-05 05:14:37');
INSERT INTO msgs VALUES(10, 2, NULL, 'this is my new msg', '2014-04-05 05:15:18', '2014-04-05 05:15:18');
INSERT INTO msgs VALUES(13, 2, NULL, 'this is my new msg', '2014-04-05 05:27:53', '2014-04-05 05:27:53');
INSERT INTO msgs VALUES(14, 2, NULL, 'test', '2014-04-07 05:24:11', '2014-04-07 05:24:11');
INSERT INTO msgs VALUES(15, 2, NULL, 'This is a cool test', '2014-04-07 05:48:23', '2014-04-07 05:48:23');
INSERT INTO msgs VALUES(16, 2, NULL, 'My really Cool msg!! Whee! #Cool', '2014-04-07 05:49:20', '2014-04-07 05:49:20');
INSERT INTO msgs VALUES(17, 2, NULL, 'Hi every one! #NiceApp', '2014-04-08 02:42:04', '2014-04-08 02:42:04');
INSERT INTO msgs VALUES(18, 17, NULL, 'Bob is the best! #GoMe', '2014-04-08 06:43:45', '2014-04-08 06:43:45');
INSERT INTO msgs VALUES(19, 17, NULL, 'Bob for the Win!!!!!!!!', '2014-04-08 06:48:54', '2014-04-08 06:48:54');
INSERT INTO msgs VALUES(20, 2, NULL, 'Why, oh my!', '2014-04-08 06:49:27', '2014-04-08 06:49:27');
INSERT INTO msgs VALUES(21, 17, NULL, 'You know it', '2014-04-08 06:49:36', '2014-04-08 06:49:36');
INSERT INTO msgs VALUES(22, 2, NULL, 'Hey buddy....', '2014-04-08 06:53:06', '2014-04-08 06:53:06');
INSERT INTO msgs VALUES(23, 2, 17, 'Bob for the Win!!!!!!!!', '2014-04-08 15:48:01', '2014-04-09 02:41:56');
INSERT INTO msgs VALUES(24, 2, 17, 'Bob is the best! #GoMe', '2014-04-08 15:48:32', '2014-04-09 02:41:59');
INSERT INTO msgs VALUES(25, 2, 17, 'Bob is the best! #GoMe', '2014-04-08 15:53:02', '2014-04-09 02:42:03');
INSERT INTO msgs VALUES(26, 2, 22, 'Hey buddy....', '2014-04-09 02:48:56', '2014-04-09 02:48:56');

CREATE TABLE IF NOT EXISTS users (
  user_id bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  user_name varchar(255) NOT NULL,
  salt varchar(255) NOT NULL,
  `password` varchar(255) NOT NULL,
  created timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  modified timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (user_id),
  UNIQUE KEY username (user_name)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=19 ;

INSERT INTO users VALUES(1, 'test', '6e6bf2b6c7e5eab91d61eddb14089c2b9870d441b3e1fd8d839f2a8070666b4562ccd2dfab36df4782a59bbffab5a0d190850f6bd133846d44fd690ae527e044', '9540e7c58ca95a2e27df59725b2965d21832b548b07ec408dd893827a6cf9b4f4ea2b0c8905fd2c93193109942a64a8b36cf4a23d162962449315b36092ed20c', '2014-03-29 05:20:11', '2014-03-29 05:20:11');
INSERT INTO users VALUES(2, 'bskrtich', '8f7a71579bb121ea86f70e27301f46fe4bbc7ee0d9321647121a9677da08c4ec95024005b59fb0b530621946f8d431ca39d64da65efbc6890cc5aaaaf85664b6', '10d4b8f864bc0e4fd78d957245108e76a259d3a661fe67cba692043adf7e6c1521bf91c7c40360f07ba1ea442b6c7ca59a1ab7bd02b319c9cc2f5400fc1765d5', '2014-04-01 02:44:28', '2014-04-09 02:50:38');
INSERT INTO users VALUES(13, 'askrtich', 'f4ea1752c217304d46e86a9e3ceeef69cb3fd4da05dd01bd65e65f594ab9ef295a487dc50f586974e52c0b9cda596a62fbca008e9fc98e18657eadb8060504e2', '60c6fdd95816f97dc1e46b6696c9a425dfc14d1c124a06c232ba80e523115edb59151beced47d5ce9983229642eaa947084199791f7881701858585cf351c23b', '2014-04-01 03:53:48', '2014-04-01 03:53:48');
INSERT INTO users VALUES(17, 'bob', '728599f74aef605bd366d5894ab9afc69936369244f4f8741c4569739834bfb0a1231ac7c6f1782cd7e913e3c9efb242beb0c584752f74e171d125a31dcac17a', 'dac859f3f02eef3eef513cd1dfb06f1aa4bb74d3b2ec288c90c4ed8ad172e99c3f4b5fcbb40608330411ee40a42f707c21e5b2fa5cf12783b123866a04c1463b', '2014-04-08 04:25:48', '2014-04-08 06:50:13');
INSERT INTO users VALUES(18, 'Test2', '4d83d8088f712a9ede4e58d7f8ee41c159f9fd1323e0c925dc0733f3300b8bcea6a9b3c9e1910533bbf375d0edfad67d2c93f7c7932f1b45a48b162d636cb239', '2729457da645531254fe4767e7a58524fe70519df1ac1d46cbc671ebffa507905e8befb3d5e8128a98942d34b3574c6bfaf2bf7ed22c264052fbf6bd2c4e0e5a', '2014-04-08 06:50:30', '2014-04-08 06:50:30');


ALTER TABLE follows
  ADD CONSTRAINT follows_ibfk_2 FOREIGN KEY (follow_user_id) REFERENCES `users` (user_id) ON UPDATE CASCADE,
  ADD CONSTRAINT follows_ibfk_1 FOREIGN KEY (user_id) REFERENCES `users` (user_id) ON UPDATE CASCADE;

ALTER TABLE msgs
  ADD CONSTRAINT msgs_ibfk_1 FOREIGN KEY (user_id) REFERENCES `users` (user_id) ON UPDATE CASCADE,
  ADD CONSTRAINT msgs_ibfk_2 FOREIGN KEY (attribution_user_id) REFERENCES msgs (msg_id) ON UPDATE CASCADE;
